$(document).ready(function(){var t,i,n=$("#canvas")[0];function e(i,e){if(n.getContext){var h=n.getContext("2d"),a=n.width,s=n.height;h.strokeStyle="rgba(174,194,224,0.3)",h.lineWidth=1,h.lineCap="round";for(var o=[],r=i,c=0;c<r;c++)o.push({x:Math.random()*a,y:Math.random()*s,l:3*Math.random(),xs:4*Math.random()-4+2,ys:10*Math.random()+10});for(var l=[],d=0;d<r;d++)l[d]=o[d];t=setInterval(function(){h.clearRect(0,0,a,s);for(var t=0;t<l.length;t++){var i=l[t];h.beginPath(),h.moveTo(i.x,i.y),h.lineTo(i.x+i.l*i.xs,i.y+i.l*i.ys),h.stroke()}!function(){for(var t=0;t<l.length;t++){var i=l[t];i.x+=i.xs,i.y+=i.ys,(i.x>a||i.y>s)&&(i.x=Math.random()*a,i.y=-20)}}()},e)}}function h(){$("#canvas").fadeOut(500),$(".smoke").removeClass("-active"),$("#thunder").hide(),clearInterval(t),clearInterval(t),sound11.pause(),sound13.pause(),sound14.pause()}n.width=window.innerWidth,n.height=window.innerHeight,function(){var t,i=[],n=30,e=2,h=400,a=400,s=new Image;function o(t){this.x=0,this.y=0,this.xVelocity=0,this.yVelocity=0,this.radius=5,this.context=t,this.draw=function(){this.image?this.context.drawImage(this.image,this.x-128,this.y-128):(this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.context.fillStyle="rgba(0, 255, 255, 1)",this.context.fill(),this.context.closePath())},this.update=function(){this.x+=this.xVelocity,this.y+=this.yVelocity,this.x>=h?(this.xVelocity=-this.xVelocity,this.x=h):this.x<=0&&(this.xVelocity=-this.xVelocity,this.x=0),this.y>=a?(this.yVelocity=-this.yVelocity,this.y=a):this.y<=0&&(this.yVelocity=-this.yVelocity,this.y=0)},this.setPosition=function(t,i){this.x=t,this.y=i},this.setVelocity=function(t,i){this.xVelocity=t,this.yVelocity=i},this.setImage=function(t){this.image=t}}function r(t,i){return Math.random()*(i-t)+t}s.onload=function(){i.forEach(function(t){t.setImage(s)})},s.src="/images/simulation_1/Smoke10.png",function(){var s=document.getElementById("smoke");if(s.getContext){t=s.getContext("2d");for(var c=0;c<n;++c){var l=new o(t);l.setPosition(r(0,h),r(0,a)),l.setVelocity(r(-e,e),r(-e,e)),i.push(l)}}else alert("Please use a modern browser")}(),t&&setInterval(function(){i.forEach(function(t){t.update()}),t.fillStyle="rgba(0, 0, 0, 0.5)",t.fillRect(0,0,400,400),i.forEach(function(t){t.draw()})},1e3/33)}(),i=function(t,i,n){this.init=function(){this.loop()};var e=this;this.c=t,this.ctx=t.getContext("2d"),this.cw=i,this.ch=n,this.mx=0,this.my=0,this.lightning=[],this.lightTimeCurrent=0,this.lightTimeTotal=50,this.rand=function(t,i){return~~(Math.random()*(i-t+1)+t)},this.hitTest=function(t,i,n,e,h,a,s,o){return!(t+n<h||h+s<t||i+e<a||a+o<i)},this.createL=function(t,i,n){this.lightning.push({x:t,y:i,xRange:this.rand(5,30),yRange:this.rand(5,25),path:[{x:t,y:i}],pathLimit:this.rand(10,35),canSpawn:n,hasFired:!1})},this.updateL=function(){for(var t=this.lightning.length;t--;){var i=this.lightning[t];i.path.push({x:i.path[i.path.length-1].x+(this.rand(0,i.xRange)-i.xRange/2),y:i.path[i.path.length-1].y+this.rand(0,i.yRange)}),i.path.length>i.pathLimit&&this.lightning.splice(t,1),i.hasFired=!0}},this.renderL=function(){for(var t=this.lightning.length;t--;){var i=this.lightning[t];this.ctx.strokeStyle="hsla(0, 100%, 100%, "+this.rand(10,100)/100+")",this.ctx.lineWidth=1,0==this.rand(0,30)&&(this.ctx.lineWidth=2),0==this.rand(0,60)&&(this.ctx.lineWidth=3),0==this.rand(0,90)&&(this.ctx.lineWidth=4),0==this.rand(0,120)&&(this.ctx.lineWidth=5),0==this.rand(0,150)&&(this.ctx.lineWidth=6),this.ctx.beginPath();var n=i.path.length;this.ctx.moveTo(i.x,i.y);for(var e=0;e<n;e++)this.ctx.lineTo(i.path[e].x,i.path[e].y),i.canSpawn&&0==this.rand(0,100)&&(i.canSpawn=!1,this.createL(i.path[e].x,i.path[e].y,!1));i.hasFired||(this.ctx.fillStyle="rgba(255, 255, 255, "+this.rand(4,12)/100+")",this.ctx.fillRect(0,0,this.cw,this.ch)),0==this.rand(0,30)&&(this.ctx.fillStyle="rgba(255, 255, 255, "+this.rand(1,3)/100+")",this.ctx.fillRect(0,0,this.cw,this.ch)),this.ctx.stroke()}},this.lightningTimer=function(){if(this.lightTimeCurrent++,this.lightTimeCurrent>=this.lightTimeTotal){for(var t=this.rand(100,i-100),e=this.rand(0,n/2),h=this.rand(1,3);h--;)this.createL(t,e,!0);this.lightTimeCurrent=0,this.lightTimeTotal=this.rand(300,500)}},this.clearCanvas=function(){this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle="rgba(0,0,0,"+this.rand(1,30)/100+")",this.ctx.fillRect(0,0,this.cw,this.ch),this.ctx.globalCompositeOperation="source-over"},$(window).on("resize",function(){e.cw=e.c.width=window.innerWidth,e.ch=e.c.height=window.innerHeight}),this.loop=function(){var t=function(){requestAnimationFrame(t,e.c),e.clearCanvas(),e.updateL(),e.lightningTimer(),e.renderL()};t()}},$(window).load(function(){if(function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}){var t=document.getElementById("thunder"),n=t.width=window.innerWidth,e=t.height=window.innerHeight,h=new i(t,n,e);!function(){for(var t=0,i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requ0estAnimationFrame;++n)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"]||window[i[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i,n){var e=(new Date).getTime(),h=Math.max(0,16-(e-t)),a=window.setTimeout(function(){i(e+h)},h);return t=e+h,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),h.init()}}),$(".stdnSmltSelect").change(function(){var t=$(".stdnSmltSelect option:selected").data("rain");1===t?(h(),$("#canvas").fadeIn(500),e(200,30),sound13.play(!0)):2===t?(h(),$("#canvas").fadeIn(500),e(1e3,15),$("#thunder").show(),sound11.play(!0)):3===t?(h(),$(".smoke").addClass("-active")):(h(),sound14.play())})});