<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <title>1주차 | 재배 시뮬레이션 스마트팜</title>
        <meta name="description" content="" />
        <meta name="viewport" content="width=1445, initial-scale=1.0" />
        <link rel="apple-touch-icon" href="icon.png" />
        <!-- Place favicon.ico in the root directory -->
        <link rel="stylesheet" href="/css/vendor/normalize.css" />
        <link rel="stylesheet" href="/css/vendor/font-awesome/css/font-awesome.min.css" />
        <script src="/js/vendor/jquery-1.12.0.min.js"></script>
        <script src="/js/vendor/t.min.js"></script>
        <link rel="stylesheet" href="/css/ctvtsmlt/pinetree/week_1_style.css" />
        <link rel="stylesheet" href="/css/vendor/jquery-ui.all.css" />
        <style>
            .miss-1-1__tipTxt {
                text-align: left;
                overflow-y: auto;
                height: 340px;
            }
            .txt2 {
                color: crimson !important;
            }
            .success__point {
                font-size: 22px;
            }
            .miss-1-3__eventBox img {
                left: 40%;
            }
            .incorrect__txt span {
                display: block !important;
            }
            .success__box {
                margin-top: 60px !important;
            }
            .ulWrap h2 {
                font-family: jalnan;
                padding-bottom: 4px;
            }
        </style>
    </head>
    <body>
        <article role="main" class="stage week-1 miss-1-1">
            <div class="stage__bg"></div>
            <div class="stage__top">
                <h1 class="stage__tit">시설양묘 1년차</h1>
                <a href="/html/ctvtsmlt/lobby.html?id=1" class="stage__exit">나가기</a>
            </div>
            <input type="checkbox" id="chkFx" checked="checked" />
            <div class="tip">
                <button type="button" class="tipBtn">선생님팁</button>
                <div class="tip__star">
                    <div class="iconStar"></div>
                    <small class="iconStar"></small>
                    <div class="tip__line">
                        <img src="/images/pinetree/bg_tip_line.png" alt="" class="tip__lineImg" />
                    </div>
                </div>
            </div>
            <div class="stage__count">
                <p class="stage__countTit">미션 도전횟수</p>
                <p class="stage__countNum">0</p>
            </div>

            <!--컨텐츠 시작 -->
            <section class="stage__content mission_01_03 -active">
                <h2 class="miss__tit">3. 상토 조제하기</h2>
                <p class="miss__txt">
                    상토를 조제하는데 중요한 기준은 묘목에게 적정한 공기를 공급 하고 원활한 배수를 제공하는 것입니다.<br />
                    피트모스와 펄라이트 질석을 적당비율로 1200L의 상토를 조제해보세요.
                </p>
                <div class="miss-1-3__bg">
                    <div style="left: 70px; top: 5%; position: absolute; display: flex; align-items: center; gap: 56px">
                        <section style="text-align: center">
                            <h2 style="font-size: 18px; font-weight: bold; padding-bottom: 4px; font-family: jalnan">상토</h2>
                            <p style="margin-top: 4px">1200L</p>
                        </section>
                        <ul class="ulWrap" style="display: flex; align-items: center; gap: 45px; text-align: center">
                            <li>
                                <h2 style="font-size: 18px; font-weight: bold">피트모스</h2>
                                <p style="margin-top: 4px"><span id="san_1" style="font-weight: 500">0</span>L</p>
                            </li>
                            <li style="width: 1px; height: 12px; background-color: #000"></li>
                            <li>
                                <h2 style="font-size: 18px; font-weight: bold">펄라이트</h2>
                                <p style="margin-top: 4px"><span id="san_2" style="font-weight: 500">0</span>L</p>
                            </li>
                            <li style="width: 1px; height: 12px; background-color: #000"></li>
                            <li>
                                <h2 style="font-size: 18px; font-weight: bold">질석</h2>
                                <p style="margin-top: 4px"><span id="san_3" style="font-weight: 500">0</span>L</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="miss-1-3__handEvent">
                    <div
                        style="
                            position: absolute;
                            left: 42px;
                            top: 100px;
                            background: #f2f2f2;
                            border: 2px solid #000;
                            z-index: 10;
                            border-radius: 16px;
                            width: 544px;
                            height: 280px;
                            overflow: hidden;
                        "
                    >
                        <img
                            id="to_3"
                            src="/images/pinetree/to_3.svg"
                            alt=""
                            style="position: absolute; left: 50%; transform: translateX(-50%); width: 60px; transition: 0.3s; opacity: 0"
                        />
                        <img
                            id="to_4"
                            src="/images/pinetree/to_4.svg"
                            alt=""
                            style="position: absolute; left: 46%; transform: translateX(-50%); width: 90px; transition: 0.3s; opacity: 0"
                        />
                        <img
                            id="to_5"
                            src="/images/pinetree/to_5.svg"
                            alt=""
                            style="position: absolute; left: 56%; transform: translateX(-50%); width: 90px; transition: 0.3s; opacity: 0"
                        />
                        <img
                            id="toImg"
                            src="/images/pinetree/to_1.png"
                            alt=""
                            style="position: absolute; left: 50%; bottom: 50px; transform: translate(-50%); width: 120px; z-index: 20; opacity: 0; transition: 0.5s"
                        />

                        <img src="/images/pinetree/to_2.png" alt="" style="width: 100%; position: absolute; left: 0; bottom: 0; z-index: 10" />
                    </div>
                </div>
                <div class="miss-1-3__eventBox -hno3"></div>
                <div class="miss-1-3__eventBox -koh">
                    <!-- <img src="/images/pinetree/week01/miss_1_3/100ml.png" alt="" /> -->
                </div>
                <div class="miss-1-3__eventBox -fertilizer">
                    <!-- <img src="/images/pinetree/week01/miss_1_3/100ml.png" alt="" /> -->
                </div>

                <div class="btnGroup">
                    <a href="#this" class="btn -reset">초기화</a>
                    <a href="#this" onclick="completeCheck()" class="btn -complete">완료</a>
                </div>

                <!--미션1-3 tip -->
                <aside class="tipBox miss-1-3">
                    <div class="tipBox__inner">
                        <div class="tipBox__tec">
                            <span class="tipBox__tecStar"></span>
                            <span class="tipBox__starLine"></span>
                        </div>
                        <div class="tipBox__txtBox">
                            <h2 class="tipBox__tit">선생님의 재배 tip</h2>
                            <p class="miss-1-1__tipTxt">
                                모든 시설양묘 체계에 적합한 이상적인 하나의 생육상토는 존재하지 않습니다.<br />
                                일반적으로 임업시설양묘에 사용되는 생육상토의 특성은<br />
                                우량한 묘목을 생산할 수 있는 능력에 영향을 미치는 특성을 말하며<br />
                                약산성 pH, 높은 양이온치환 능력, 적절한 공극률,<br />
                                유해물로부터 건전성 등이 있습니다.<br /><br />시설양묘 경영자는 경영적인 관점에서는 생육상토 또는 개개 혼합 재료의 선택에 있어<br />
                                적정 가격 및 활용성, 높은 균일성과 지속적인 생산ㆍ공급능력, 낮은 용적밀도, <br />
                                내구성과 편리한 저장, 편리한 상토혼합 및 상토채우기, 편리한 재습윤성 및<br />
                                견고한 뿌리촉진 능력 등이 중요한 요소가 됩니다.<br /><br />국내 임업시설양묘에서는 생육상토를 보통 피트모스, <br />펄라이트, 질석을
                                1:1:1(용적기준)의 비율로 골고루 혼합하여 조제합니다. <br />양묘장에서 대량의 상토가 필요하면 그 지역 제품의 혼합 상토를 권장합니다. <br />그 이유는
                                질석 미립자가 종종 포장, 선적, 운반 과정에서 <br />
                                분쇄되어 치밀해지기 때문입니다.
                            </p>
                            <p class="miss-1-1__tipTxt txt2">피트모스 : 펄라이트 : 질석 = 1:1:1</p>
                            <button type="button" class="tipBox__close">창닫기</button>
                        </div>
                    </div>
                </aside>
                <!-- 틀림답 -->
                <aside class="incorrect miss-1-1">
                    <div class="incorrect__inner">
                        <button type="button" class="incorrect__handBox">
                            <span class="incorrect__handImg"></span>
                            <p class="incorrect__txt">
                                <span class="answer -type01">pH가 높습니다.</span>
                                <span class="answer -type02">pH가 낮습니다.</span>
                                <span class="answer -type03">EC가 높습니다.</span>
                                <span class="answer -type04">EC가 낮습니다.</span><br />
                                다시 시도해보세요.
                            </p>
                        </button>
                    </div>
                </aside>

                <!-- 미션 성공 -->
                <aside class="success miss-1-1">
                    <div class="success__inner">
                        <h2 class="success__tit"><img src="/images/pinetree/txt_complete.png" alt="미션성공" /></h2>
                        <p class="success__point">
                            피트모스 : 펄라이트 : 질석 = 1:1:1 비율로
                            <br />
                            상토 조제를 성공적으로 마쳤습니다.
                        </p>
                        <div class="success__box">
                            <img src="/images/pinetree/week01/miss_1_3/success_miss_1_3.png" alt="" />
                        </div>
                        <a href="/html/ctvtsmlt/lobby.html" class="btnMain" style="left: 42%"></a>
                        <a href="/html/ctvtsmlt/pinetree/mission_01_04.html_01_04.html" class="btnNext" style="left: 58%">
                            <img src="/images/sprite/nextBtn.png" alt="" />
                        </a>
                    </div>
                </aside>
            </section>
            <!--컨텐츠 끝 -->
        </article>
    </body>
    <script src="/js/vendor/jquery.ui.datapicker.min.js"></script>
    <script src="/js/vendor/waypoints.min.js"></script>
    <script src="/js/vendor/datepicker-ko.js"></script>
    <script src="/js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="/js/vendor/jquery.easing.1.3.js"></script>
    <script src="/js/vendor/slick.min.js"></script>
    <script src="/js/vendor/jquery.counterup.min.js"></script>
    <script src="/js/ui.js"></script>

    <script src="/js/vendor/jquery.confetti.js"></script>
    <script src="/js/vendor/jquery-ui.js"></script>
    <script src="/js/miss.min.js"></script>
    <script src="/js/sound.min.js"></script>
    <script>
        $(document).ready(function () {
            loadingComplete();
            var challengeCount = 0; //도전횟수
        });

        const toImg = document.getElementById("toImg");
        const to_3 = document.getElementById("to_3");
        const to_4 = document.getElementById("to_4");
        const to_5 = document.getElementById("to_5");

        const san_1 = document.getElementById("san_1");
        const san_2 = document.getElementById("san_2");
        const san_3 = document.getElementById("san_3");

        document.querySelector(".-koh").addEventListener("click", function () {
            if (parseInt(san_2.innerText) < 400) {
                if (toImg.style.opacity === "0") {
                    toImg.style.opacity = "1";
                } else {
                    if (toImg.width < 320) {
                        toImg.style.width = parseInt(toImg.style.width) + 50 + "px";
                    }
                }
                to_4.style.opacity = "1";
                san_2.innerText = parseInt(san_2.innerText) + 100;
                setTimeout(function () {
                    to_4.style.opacity = "0";
                }, 1000);
                soundFx(sound_sap);
                chkType = "phUp";
                // this.innerHTML += '<img src="/images/pinetree/week01/miss_1_3/100ml.png" alt="">';
                setTimeout(function () {
                    document.querySelector(".-koh img:nth-child(2)").remove();
                }, 1000);
                document.querySelector(".miss-1-3__hand .-koh").classList.add("-active");
                Array.from(document.querySelector(".miss-1-3__hand .-koh").parentNode.children).forEach(function (child) {
                    if (child !== document.querySelector(".miss-1-3__hand .-koh")) {
                        child.classList.remove("-active");
                    }
                });
            }
        });

        document.querySelector(".-hno3").addEventListener("click", function () {
            if (parseInt(san_1.innerText) < 400) {
                if (toImg.style.opacity === "0") {
                    toImg.style.opacity = "1";
                } else {
                    if (toImg.width < 320) {
                        toImg.style.width = parseInt(toImg.style.width) + 50 + "px";
                    }
                }
                to_5.style.opacity = "1";
                san_1.innerText = parseInt(san_1.innerText) + 200;
                setTimeout(function () {
                    to_5.style.opacity = "0";
                }, 1000);
                soundFx(sound_sap);
                chkType = "phDown";
                // this.innerHTML += '<img src="/images/pinetree/week01/miss_1_3/100ml.png" alt="">';
                setTimeout(function () {
                    document.querySelector(".-hno3 img:nth-child(2)").remove();
                }, 1000);
                document.querySelector(".miss-1-3__hand .-hno").classList.add("-active");
                Array.from(document.querySelector(".miss-1-3__hand .-hno").parentNode.children).forEach(function (child) {
                    if (child !== document.querySelector(".miss-1-3__hand .-hno")) {
                        child.classList.remove("-active");
                    }
                });
            }
        });

        document.querySelector(".-fertilizer").addEventListener("click", function () {
            if (parseInt(san_3.innerText) < 400) {
                if (toImg.style.opacity === "0") {
                    toImg.style.opacity = "1";
                } else {
                    if (toImg.width < 320) {
                        toImg.style.width = parseInt(toImg.style.width) + 50 + "px";
                    }
                }
                san_3.innerText = parseInt(san_3.innerText) + 50;
                to_3.style.opacity = "1";
                setTimeout(function () {
                    to_3.style.opacity = "0";
                }, 1000);
                soundFx(sound_sap);
                chkType = "ecUp";
                // this.innerHTML += '<img src="/images/pinetree/week01/miss_1_3/100ml.png" alt="">';
                setTimeout(function () {
                    document.querySelector(".-fertilizer img:nth-child(2)").remove();
                }, 1000);
                document.querySelector(".miss-1-3__hand .-biro").classList.add("-active");
                Array.from(document.querySelector(".miss-1-3__hand .-biro").parentNode.children).forEach(function (child) {
                    if (child !== document.querySelector(".miss-1-3__hand .-biro")) {
                        child.classList.remove("-active");
                    }
                });
            }
        });

        document.querySelector(".-reset").addEventListener("click", function () {
            san_1.innerText = 0;
            san_2.innerText = 0;
            san_3.innerText = 0;
            toImg.style.opacity = "0";
            toImg.style.width = "120px";
        });

        const incorrect__txt = document.querySelector(".incorrect__txt");
        const missPage = document.querySelector(".incorrect");
        const missAudio = new Audio("/sound/strawberry/01_Wrong.mp3");
        let missNum = 0;
        const stage__countNum = document.querySelector(".stage__countNum");

        function showMessageAndIncreaseMissNum(message) {
            incorrect__txt.innerHTML = message;
            missPage.style.opacity = "1";
            missPage.style.transform = "scale(1)";
            missPage.style.visibility = "visible";
            missNum++;
            stage__countNum.innerText = missNum;
        }

        function completeCheck() {
            let san_1_value = parseInt(san_1.innerText);
            let san_2_value = parseInt(san_2.innerText);
            let san_3_value = parseInt(san_3.innerText);

            if (san_1_value === 400 && san_2_value === 400 && san_3_value === 400) {
                // 모든 재료가 400일 경우 정답 처리
                new Audio("/sound/sound_yea.mp3").play();
                clear();
            } else if (san_1_value < 1 && san_2_value < 1 && san_3_value < 1) {
                showMessageAndIncreaseMissNum('<span class="answer -type01">조제를 시도해보세요.</span>');
            } else if (san_1_value < 400 && san_2_value < 400 && san_3_value < 400) {
                showMessageAndIncreaseMissNum('<span class="answer -type01">모든 재료가 부족합니다.<br/>다시 시도해보세요.</span>');
            } else {
                let messages = [];
                if (san_1_value !== 400) {
                    messages.push("피트모스");
                }
                if (san_2_value !== 400) {
                    messages.push("펄라이트");
                }
                if (san_3_value !== 400) {
                    messages.push("질석");
                }
                let message = "";
                if (messages.length === 1) {
                    message = `${messages[0]}이 부족합니다.`;
                } else {
                    message = `${messages.join(", ")} 재료가<br/> 부족하거나 많습니다.`;
                }
                showMessageAndIncreaseMissNum(`<span class="answer -type01">${message}<br/>다시 시도해보세요.</span>`);
            }

            missPage.addEventListener("click", function () {
                setTimeout(() => (missPage.querySelector(".answer").style.display = "none"), 300);
                missPage.style.opacity = "0";
                missPage.style.transform = "scale(0)";
                missPage.style.visibility = "hidden";
            });
        }
    </script>
</html>
